# 🚀 План развития социальных функций и вовлеченности

## ✅ Уже реализовано (в этом коммите):

### 1. Огоньки активности (слева направо) ✅
- Отсчет начинается с первого дня серии
- Слева = старые дни, справа = новые дни

### 2. Московское время (MSK, UTC+3) ✅
- Все даты и время приведены к MSK
- Единообразный отсчет для всех пользователей

### 3. Social Sharing ✅
- Компонент `SocialShare.tsx`
- Поддержка: Telegram, LinkedIn, Facebook, Twitter, VK
- Красивая карточка с статистикой
- Реферальная ссылка с копированием

### 4. Weekly Challenges ✅
- 8 тематических челленджей по 10 вопросов
- Автоматическая ротация каждую неделю
- Прогресс и награды (XP + badges)

---

## 📊 Предложения по разделу "Статистика"

### Вариант 1: Табы (рекомендуемый)
```
┌─────────────────────────────────────────┐
│ Статистика                              │
├─────────────────────────────────────────┤
│ [Прогресс] [Квесты] [Челленджи] [Друзья]│
├─────────────────────────────────────────┤
│                                         │
│  Контент активного таба                 │
│                                         │
└─────────────────────────────────────────┘
```

**Табы:**
- **Прогресс**: текущая статистика (категории, уровни, XP)
- **Квесты**: ежедневные + milestone квесты
- **Челленджи**: текущий weekly challenge + история
- **Друзья**: leaderboard среди друзей, сравнение

### Вариант 2: Секции (как сейчас, но расширенные)
```
┌─────────────────────────────────────────┐
│ Статистика                              │
├─────────────────────────────────────────┤
│ 📊 Твой прогресс                        │
│ ├─ XP, уровень, серия                   │
│                                         │
│ 🎯 Активные квесты                      │
│ ├─ Ежедневные (2)                       │
│ ├─ Milestone (3)                        │
│                                         │
│ 🏆 Челлендж недели                      │
│ ├─ Неделя 3: Размер выборки (6/10)     │
│                                         │
│ 👥 Друзья                               │
│ ├─ Топ-5 среди друзей                  │
│                                         │
│ 📈 Детальная статистика                 │
│ ├─ Категории, способности              │
└─────────────────────────────────────────┘
```

### Вариант 3: Отдельные страницы
- `/stats` - основная статистика
- `/stats/quests` - все квесты
- `/stats/challenges` - челленджи
- `/stats/friends` - друзья и leaderboard

**Рекомендация**: **Вариант 1 (Табы)** - самый удобный для навигации

---

## 🤝 Система друзей: варианты определения

### Вариант 1: Через Telegram бота (рекомендуемый)
**Как работает:**
1. Пользователь подключает Telegram через бота
2. Бот запрашивает разрешение на доступ к контактам
3. Автоматически определяет друзей среди пользователей приложения

**Преимущества:**
- ✅ Автоматическое определение друзей
- ✅ Push-уведомления через Telegram
- ✅ Не нужно вручную добавлять друзей
- ✅ Виральность (друзья видят что вы используете)

**Недостатки:**
- ⚠️ Требует подключения Telegram
- ⚠️ Privacy concerns (доступ к контактам)

### Вариант 2: Реферальная система
**Как работает:**
1. Пользователь приглашает через реферальную ссылку
2. Приглашенный регистрируется по ссылке
3. Автоматически добавляются в друзья

**Преимущества:**
- ✅ Явное согласие (пригласил = друг)
- ✅ Мотивация приглашать (бонусы)
- ✅ Отслеживание источника трафика

**Недостатки:**
- ⚠️ Ручной процесс
- ⚠️ Медленный рост сети

### Вариант 3: Комбинированный (рекомендуемый)
**Друзьями считаются:**
1. Те, кого пригласил (реферальная ссылка)
2. Те, кто тебя пригласил (взаимно)
3. Контакты из Telegram (если подключен)
4. Ручное добавление по email/username

---

## 📱 Telegram бот: функционал

### MVP функции:
1. **Аутентификация**
   - Связывание аккаунта с Telegram ID
   - OAuth через Google + Telegram

2. **Push-уведомления**
   - Ежедневное напоминание (настраиваемое время)
   - Уведомление о потере серии
   - Новые квесты и челленджи
   - Активность друзей

3. **Быстрые действия**
   - `/start` - начать сегодняшний квест
   - `/stats` - показать статистику
   - `/friends` - друзья и leaderboard
   - `/challenge` - текущий челлендж

4. **Определение друзей**
   - Сканирование контактов (с разрешением)
   - Автоматическое добавление друзей
   - Уведомления когда друг присоединяется

### Техническая реализация:
```
Telegram Bot API
     ↓
Firebase Functions (webhook)
     ↓
Firestore (user_id <-> telegram_id)
     ↓
Web App (обновление прогресса)
```

**Команды бота:**
- `/link` - привязать аккаунт
- `/daily` - сегодняшний квест
- `/stats` - статистика
- `/friends` - друзья
- `/challenge` - челлендж недели
- `/notify on/off` - включить/выключить уведомления
- `/time 18:00` - установить время напоминания

---

## 🎁 Реферальная программа

### Награды за приглашения:
- **1 друг**: +100 XP, 🎲 Пропуск вопроса
- **3 друга**: +300 XP, 🛡️ Защита серии, значок "Рекрутер"
- **5 друзей**: +500 XP, 🎁 Premium доступ на неделю
- **10 друзей**: +1000 XP, значок "Амбассадор" 👑

### Квест на приглашение:
```typescript
{
  id: 'referral-quest',
  title: '👥 Пригласи друга',
  description: 'Поделись реферальной ссылкой и получи бонус когда друг зарегистрируется',
  progress: { current: 0, total: 1 },
  reward: 100,
  rewards: [
    { type: 'xp', value: 100, description: '+100 XP' },
    { type: 'item', itemType: 'question_skip', value: 1, description: '🎲 Пропуск' }
  ],
  type: 'achievement'
}
```

---

## 📍 Что показывать в Header?

### Вариант 1: Ключевые метрики (компактно)
```
┌────────────────────────────────────────┐
│ [<] A/B Trainer    🔥3  ⭐150  📊L15  │
└────────────────────────────────────────┘
```
- 🔥 - серия дней
- ⭐ - XP
- 📊 - уровень

### Вариант 2: Текущий челлендж
```
┌────────────────────────────────────────┐
│ [<] Week 3 Challenge    ⚡ 6/10        │
└────────────────────────────────────────┘
```

### Вариант 3: Адаптивный (зависит от экрана)
- **GameScreen**: показывать текущий прогресс вопросов
- **StatisticsScreen**: ничего (дублирование)
- **LearningPath**: общий прогресс (35% модулей)
- **ModuleDetail**: прогресс модуля

**Рекомендация**: **Вариант 3 (Адаптивный)** - избегаем дублирования

---

## 🎯 Следующие шаги:

1. ✅ Интегрировать SocialShare в GameScreen/Statistics
2. ✅ Добавить WeeklyChallengeWidget
3. ⏳ Создать Telegram бота (отдельный проект)
4. ⏳ Переработать Statistics с табами
5. ⏳ Добавить реферальный квест
6. ⏳ Интегрировать систему друзей

---

**Автор**: AI Assistant  
**Дата**: 2025-10-26  
**Версия**: 1.0

